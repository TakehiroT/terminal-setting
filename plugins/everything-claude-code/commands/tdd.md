---
description: TDDワークフローを実行する
allowed-tools: Read, Write, Edit, Bash, Glob, Grep, Task, TodoWrite
---

# /tdd - テスト駆動開発コマンド

tdd-guideエージェントを使用してテスト駆動開発のワークフローを実行します。

## 使用方法

```
/tdd [機能の説明]
```

## TDDサイクル（Red-Green-Refactor）

### 1. Red: テストを書く（失敗するテスト）

```bash
# テストファイルを作成
# 期待する動作を定義
# テストを実行して失敗を確認
```

- まず失敗するテストを書く
- 期待する振る舞いを明確に定義
- テストが適切に失敗することを確認

### 2. Green: 最小限の実装でテストを通す

```bash
# 最小限のコードを実装
# テストを実行してパスすることを確認
```

- テストを通すための最小限の実装
- まずは動作させることを優先
- コードの美しさは後回し

### 3. Refactor: コードを改善

```bash
# リファクタリングを実行
# テストを再実行して動作を保証
```

- コードの品質を向上
- 重複を削除
- 可読性を改善
- テストが通り続けることを確認

## 実行手順

1. **要件の確認**
   - 実装する機能の仕様を明確化
   - テストケースを洗い出し

2. **テスト作成（Red）**
   - テストファイルを作成
   - 期待する動作をテストコードで表現
   - `pnpm test` または適切なテストコマンドで失敗を確認

3. **実装（Green）**
   - テストを通すための最小限の実装
   - テストコマンドで成功を確認

4. **リファクタリング（Refactor）**
   - コードの改善
   - テストの改善
   - 再度テストを実行して動作保証

5. **繰り返し**
   - 次の機能について1-4を繰り返し
   - 継続的にテストスイートを充実させる

## tdd-guideエージェントの役割

- TDDサイクルのガイド
- 適切なテストケースの提案
- テストコードのレビューと改善提案
- 実装のガイダンス
- リファクタリングの提案

## テストの種類

### ユニットテスト
- 個別の関数やメソッドをテスト
- 高速で実行可能
- 依存関係をモック化

### 統合テスト
- 複数のモジュールの連携をテスト
- より実践的なシナリオ
- 外部依存を含む場合も

## ベストプラクティス

- **小さく始める**: 最も単純なケースから
- **1つずつ**: 一度に1つの機能に集中
- **高速実行**: テストは素早く実行できるように
- **独立性**: テスト間の依存を避ける
- **明確な命名**: テストの意図が分かる名前を付ける

## 使用例

```bash
# ユーザー登録機能をTDDで実装
/tdd ユーザー登録機能（メールアドレスとパスワード）

# バリデーション機能をTDDで実装
/tdd 入力値のバリデーション（必須チェック、形式チェック）

# APIエンドポイントをTDDで実装
/tdd GET /api/users エンドポイントの実装
```

## 進捗管理

実装の進捗は `.spec/<feature>/test.md` に記録されます：

```markdown
# [機能名] TDD進捗

## テストケース
- [x] ケース1: 正常系
- [x] ケース2: 異常系（必須項目未入力）
- [ ] ケース3: 異常系（形式エラー）

## 実装状況
- Red: ✓
- Green: ✓
- Refactor: 進行中
```
