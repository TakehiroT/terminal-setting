# エージェント使用ガイド

## エージェント選択の原則

- **専門性**: タスクに最適なエージェントを選択
- **単一責任**: 1つのエージェントに複数の役割を持たせない
- **段階的実行**: 計画 → 設計 → 実装 → テスト → 検証の順序

## 利用可能なエージェント

### planner（計画立案）

**役割**: タスクの分析と実行計画の策定

**使用タイミング**:
- プロジェクト開始時
- 大規模な機能追加前
- 複雑な問題の分析が必要な時

**成果物**:
- タスク分解リスト
- 実行順序の定義
- 依存関係の明確化

**使用例**:
```
/task planner "ECサイトにカート機能を追加する計画を立てて"
```

### architect（アーキテクチャ設計）

**役割**: システム設計とアーキテクチャ決定

**使用タイミング**:
- 新規プロジェクト立ち上げ
- 大規模リファクタリング前
- 技術選定が必要な時

**成果物**:
- アーキテクチャ図
- ディレクトリ構造
- 技術スタック選定理由

**使用例**:
```
/task architect "マイクロサービスアーキテクチャの設計を提案して"
```

### tdd-guide（TDDワークフロー）

**役割**: テスト駆動開発のサポート

**使用タイミング**:
- 新機能開発時
- バグ修正時（再発防止）
- テストカバレッジ向上時

**ワークフロー**:
1. 失敗するテストを書く（Red）
2. テストを通す実装（Green）
3. リファクタリング（Refactor）

**使用例**:
```
/task tdd-guide "ユーザー認証機能をTDDで実装して"
```

### build-error-resolver（ビルドエラー解決）

**役割**: ビルド・コンパイルエラーの診断と修正

**使用タイミング**:
- ビルドが失敗した時
- 型エラーが発生した時
- 依存関係の問題が起きた時

**対応範囲**:
- TypeScript型エラー
- Lintエラー
- パッケージの依存関係エラー
- ビルド設定の問題

**使用例**:
```
/task build-error-resolver "TypeScriptのビルドエラーを解決して"
```

### e2e-runner（E2Eテスト実行）

**役割**: E2Eテストの作成と実行

**使用タイミング**:
- 主要フローのテストが必要な時
- リグレッションテスト追加時
- デプロイ前の最終確認

**対応範囲**:
- Playwright/Cypressテスト作成
- テストシナリオ設計
- テスト実行とレポート

**使用例**:
```
/task e2e-runner "ログインから商品購入までのE2Eテストを作成して"
```

### refactor-cleaner（リファクタリング・デッドコード削除）

**役割**: コード品質改善とクリーンアップ

**使用タイミング**:
- コードレビュー後
- 機能削除後
- 定期的なメンテナンス

**対応範囲**:
- 未使用コードの削除
- 重複コードの統合
- コード構造の改善
- パフォーマンス最適化

**使用例**:
```
/task refactor-cleaner "未使用の関数とimportを削除して"
```

### doc-updater（ドキュメント更新）

**役割**: ドキュメントの作成と更新

**使用タイミング**:
- 新機能追加後
- API変更後
- プロジェクト立ち上げ時

**対応範囲**:
- README更新
- APIドキュメント生成
- コメント追加
- 変更履歴記録

**使用例**:
```
/task doc-updater "新しいAPI仕様をドキュメントに追加して"
```

## エージェントの組み合わせパターン

### パターン1: 新機能開発

```
1. /task planner "機能Xの実装計画"
2. /task architect "機能Xのアーキテクチャ設計"
3. /task tdd-guide "機能Xの実装"
4. /task e2e-runner "機能XのE2Eテスト"
5. /task doc-updater "機能Xのドキュメント作成"
```

### パターン2: バグ修正

```
1. /task tdd-guide "バグ再現テストを作成"
2. /task build-error-resolver "エラーを修正"
3. /task e2e-runner "回帰テストを実行"
```

### パターン3: リファクタリング

```
1. /task architect "リファクタリング方針を設計"
2. /task refactor-cleaner "コードをクリーンアップ"
3. /task build-error-resolver "ビルドエラーを解決"
4. /task e2e-runner "動作確認"
```

### パターン4: 技術的負債の解消

```
1. /task planner "負債解消の優先順位を決定"
2. /task refactor-cleaner "デッドコードを削除"
3. /task tdd-guide "テストカバレッジを向上"
4. /task doc-updater "ドキュメントを整備"
```

## エージェント使用時の注意点

### DO（推奨）

- タスクを明確に指示する
- エージェントの専門性を活かす
- 段階的に進める
- 成果物を確認してから次へ

### DON'T（非推奨）

- 複数の役割を1つのエージェントに押し付ける
- 曖昧な指示で実行させる
- エージェント間の順序を無視する
- 成果物を確認せずに次に進む

## カスタムエージェントの作成

プロジェクト固有のエージェントが必要な場合:

1. `.claude/agents/` にYAMLファイルを作成
2. 役割と責任を明確に定義
3. 使用するツールを指定
4. サンプル使用例を記載

```yaml
# .claude/agents/api-generator.yaml
name: api-generator
description: RESTful APIのスキャフォールディング
tools:
  - read
  - write
  - bash
prompt: |
  OpenAPI仕様からAPIエンドポイントを生成します。
  - コントローラー、サービス、ルーターを自動生成
  - バリデーションスキーマを含む
  - テストコードも同時に生成
```

## トラブルシューティング

### エージェントが期待通り動かない

- タスクの指示が明確か確認
- 必要なファイルが存在するか確認
- 依存関係が解決されているか確認

### どのエージェントを使うべきか分からない

- タスクの種類で判断（計画/設計/実装/テスト/ドキュメント）
- 複数のエージェントを組み合わせる
- オーケストレーターに相談
